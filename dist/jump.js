(()=>{"use strict";let t,e,n="",o=null;function s(t){const e=o||(o=document.createElement("div"),o.id="easy-egov-jump-hud",Object.assign(o.style,{position:"fixed",bottom:"40px",left:"50%",transform:"translateX(-50%) translateY(20px)",backgroundColor:"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)",padding:"12px 24px",borderRadius:"16px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.04)",border:"1px solid rgba(255, 255, 255, 0.4)",color:"#1a1a1a",fontSize:"18px",fontWeight:"600",fontFamily:'"Outfit", "Inter", "Roboto", sans-serif',zIndex:"10000",display:"flex",alignItems:"center",gap:"12px",opacity:"0",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",pointerEvents:"none",letterSpacing:"0.05em"}),o.innerHTML='\n    <span style="opacity: 0.5; font-size: 14px; text-transform: uppercase;">Jump to</span>\n    <span id="easy-egov-jump-text"></span>\n  ',document.body.appendChild(o),o),n=document.getElementById("easy-egov-jump-text");if(t.length>0){const o=t.trim().split(/\s+/),s=o[0]||"",r=o.slice(1).join("の"),i=`第${s}条${r?"の"+r:""}`;n&&(n.textContent=i),e.style.opacity="1",e.style.transform="translateX(-50%) translateY(0)"}else e.style.opacity="0",e.style.transform="translateX(-50%) translateY(20px)"}function r(){t&&window.clearTimeout(t),t=window.setTimeout(()=>{n="",s("")},1e3)}function i(t){if(0===t)return"〇";const e=["","十","百","千"],n=["","一","二","三","四","五","六","七","八","九"];let o="";const s=t.toString();for(let t=0;t<s.length;t++){const r=s[s.length-1-t];if(!r)continue;const i=parseInt(r),l=t%4;0!==i&&(o=(1===i&&l>0?"":n[i]||"")+(e[l]||"")+o),3===t&&s.length>4&&(o="万"+o)}return o}function l(t){return t.replace(/[0-9]/g,t=>String.fromCharCode(t.charCodeAt(0)+65248))}function a(t){const e=t.style.backgroundColor,n=t.style.transition;t.style.transition="all 0.6s cubic-bezier(0.4, 0, 0.2, 1)",t.style.backgroundColor="rgba(255, 230, 0, 0.35)",setTimeout(()=>{t.style.backgroundColor=e,setTimeout(()=>{t.style.transition=n},600)},2e3)}function c(){e&&clearTimeout(e),n.endsWith(" ")||(e=window.setTimeout(()=>{n.length>0&&function(t){const n=t.trim().split(/\s+/);if(0===n.length||""===n[0])return;const o=n[0];if(!o)return;const s=parseInt(o);if(isNaN(s))return;const r=n[0],c=l(r),u=i(s),d=n.slice(1),p=[`第${r}条${d.length>0?"の"+d.join("の"):""}`,`第${c}条${d.length>0?"の"+d.map(t=>l(t)).join("の"):""}`,`第${u}条${d.length>0?"の"+d.map(t=>i(parseInt(t))).join("の"):""}`],f=[];for(const t of p){const e=`//*[(contains(@class, "ArticleTitle") or contains(@class, "ParagraphNum")) and contains(., "${t}")]`,n=document.evaluate(e,document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(let e=0;e<n.snapshotLength;e++){const o=n.snapshotItem(e);if(o.closest("a"))continue;const s=(o.textContent||"").replace(/[\s,]/g,""),r=s.indexOf(t);if(-1===r)continue;const i=s[r+t.length];if(i&&/[0-9０-９の]/.test(i))continue;let l=0;const a=o.getAttribute("class")||"";a.includes("ArticleTitle")&&(l+=1e3),a.includes("ParagraphNum")&&(l+=500),0===r&&(l+=2e3),f.push({node:o,score:l,text:t})}if(f.length>0)break;const o=`//*[not(self::script) and not(self::style) and contains(., "${t}")]`,s=document.evaluate(o,document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(let e=0;e<s.snapshotLength;e++){const n=s.snapshotItem(e);if(n.closest("a"))continue;const o=(n.textContent||"").replace(/[\s,]/g,""),r=o.indexOf(t);if(-1===r)continue;const i=o[r+t.length];if(i&&/[0-9０-９の]/.test(i))continue;let l=n;const a=n.querySelectorAll("*");for(const e of Array.from(a)){const n=(e.textContent||"").replace(/[\s,]/g,""),o=n.indexOf(t);if(-1!==o){const s=n[o+t.length];s&&/[0-9０-９の]/.test(s)||(l=e)}}f.push({node:l,score:0===r?100:0,text:t})}if(f.length>0)break}if(f.length>0){f.sort((t,e)=>e.score-t.score);const t=f[0];t.node.scrollIntoView({behavior:"auto",block:"center"}),function(t,e){const n=t.textContent||"",o=e.split("").map(t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("\\s*"),s=new RegExp(o,"i"),r=n.match(s);if(!r||void 0===r.index)return void a(t);const i=r.index,l=i+r[0].length,c=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null);let u=0;const d=document.createRange();let p,f=null,g=0,m=null,h=0;for(;p=c.nextNode();){const t=p,e=t.textContent?.length||0;if(!f&&u+e>i&&(f=t,g=i-u),f&&u+e>=l){m=t,h=l-u;break}u+=e}if(f&&m){d.setStart(f,g),d.setEnd(m,h);const e=document.createElement("span");Object.assign(e.style,{backgroundColor:"rgba(255, 230, 0, 0.45)",boxShadow:"0 0 12px rgba(255, 215, 0, 0.3)",borderRadius:"4px",padding:"2px 0",transition:"all 0.6s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"default"});try{d.surroundContents(e),setTimeout(()=>{e.style.backgroundColor="transparent",e.style.boxShadow="none",setTimeout(()=>{if(e.parentNode){const t=e.parentNode;for(;e.firstChild;)t.insertBefore(e.firstChild,e);t.removeChild(e),t.normalize()}},600)},2e3)}catch(e){a(t)}}else a(t)}(t.node,t.text),e&&clearTimeout(e)}else console.log(`Article targets ${JSON.stringify(p)} not found. (Input: "${t}")`)}(n)},500))}document.addEventListener("keydown",t=>{const o=t.target;if(!["INPUT","TEXTAREA","SELECT","CONTENTEDITABLE"].includes(o.tagName)&&!o.isContentEditable)if(/^[0-9 ]$/.test(t.key)){if(" "===t.key&&0===n.length)return;" "===t.key&&t.preventDefault(),n+=t.key,s(n),r(),c()}else"Backspace"===t.key?n.length>0&&(n=n.slice(0,-1),s(n),r(),c()):"Escape"===t.key&&(n="",s(""),e&&clearTimeout(e))})})();
//# sourceMappingURL=jump.js.map